
%(BEGIN_QUESTION)
% Copyright 2015, Tony R. Kuphaldt, released under the Creative Commons Attribution License (v 1.0)
% This means you may do almost anything with this work of mine, so long as you give me proper credit

A computer spreadsheet program may be used as a simulator for a proportional-only controller.  By entering sets of values for Process Variable (PV), Setpoint (SP), Gain (K\_P), and Bias (B), we may program a spreadsheet to calculate the output values (in percent) that a real proportional controller would generate.

A sample layout is presented here, where yellow shading represents ``live'' values to enter for PV and SP, orange shading represents ``static'' values to enter for gain ($K_p$) and bias ($b$), and blue shading represents the output value calculated by the spreadsheet (the controller).  Color-shading is completely optional, having no effect whatsoever on the operation of the spreadsheet:

$$\includegraphics[width=15.5cm]{i03630x01.eps}$$

Write an equation for cell {\tt R5C1} to calculate the proportional output according to the following proportional-only controller formula:

$$m = K_p (\hbox{SP} - \hbox{PV}) + b$$

Does this formula describe a {\it direct-acting} controller or a {\it reverse-acting} controller?  What would need to be altered in the formula to make it exhibit the opposite direction of action?

\vskip 10pt

Experiment with your spreadsheet when you are done to explore the action of a proportional-only controller.  It is recommended that you begin with a gain value of 1, a bias value of 50\%, and with both PV and SP values set equal to each other at some value around 50\%.  The following experiments are recommended, in no particular order:

\begin{itemize}
\item{} Try increasing the PV value while leaving SP unchanged.  Which way does the Output value change, and why?
\vskip 5pt
\item{} Try increasing the SP value while leaving PV unchanged.  Which way does the Output value change, and why?
\vskip 5pt
\item{} Try altering both the PV and SP values by the same amount, in the same direction.  What happens to the Output value when you do so, and why?
\vskip 5pt
\item{} Try altering the gain value when PV and SP are unequal by no more than a few percent.  What happens to the Output value, and why?
\vskip 5pt
\item{} Try altering the gain value with PV = SP.  What happens to the Output value, and why? 
\vskip 5pt
\item{} Modify the formula to switch this controller's action, then repeat the above experiments.
\end{itemize}

\vskip 20pt \vbox{\hrule \hbox{\strut \vrule{} {\bf Suggestions for Socratic discussion} \vrule} \hrule}

\begin{itemize}
\item{} What is the purpose of including a {\it bias} value in the proportional control equation?
\item{} Explain how to alter the spreadsheet to accept {\it proportional band} values instead of {\it gain} values for $K_p$.
\item{} Identify a way to change the action of this controller algorithm without altering any equation in the spreadsheet.
\end{itemize}

\underbar{file i03630}
%(END_QUESTION)





%(BEGIN_ANSWER)

{\bf Cell R5C1:} {\tt = R2C4 * (R2C2 - R2C1) + R2C5} 

\vskip 10pt

It is recommended that you select ``\%'' display formatting for PV, SP, bias, and Output cells.  This way, all those values will have the percent symbol automatically attached to them.
 
%(END_ANSWER)





%(BEGIN_NOTES)

\vfil \eject

\noindent
{\bf Prep Quiz:}

Write the equation for a {\it direct-acting} proportional controller, containing the variables PV, SP, $K_p$ (gain), and $b$ (bias):

\vskip 10pt

$m =$

\vfil \eject

\noindent
{\bf Prep Quiz:}

Write the equation for a {\it reverse-acting} proportional controller, containing the variables PV, SP, $K_p$ (gain), and $b$ (bias):

\vskip 10pt

$m =$


%INDEX% Computer spreadsheet exercise: proportional-only controller response

%(END_NOTES)


